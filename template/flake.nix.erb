{
  description = "<%= project %>";

  inputs = {
    nixpkgs.url = github:NixOS/nixpkgs;
  };

  outputs = { self, nixpkgs }:
    let
      name = "<%= project %>";
      system = "x86_64-linux";
      version = "0.0.1";
      pkgs = import nixpkgs { inherit system; };

      gems = pkgs.bundlerEnv {
        name = "${pname}-${version}-bundler-env";
        ruby = pkgs.<%= ruby %>;
        gemfile = <%= gemfile_path %>;
        lockfile = <%= lockfile_path %>;
        gemset = <%= gemset_path %>;
      };
    in {
      packages.${system} = {
        default = stdenv.mkDerivation {
          inherit pname version;
          buildInputs = [
            gems
            gems.ruby
          ];
        };
        gems = gems;
      };

      devShell.${system} = pkgs.mkShell {
        buildInputs = [
          gems
          gems.ruby
        ];
      };
    };
}
